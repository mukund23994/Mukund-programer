<h2>Checkout</h2>

<form id="checkoutForm">
  <label>Name:</label><br>
  <input type="text" id="name" required><br><br>

  <label>Phone:</label><br>
  <input type="text" id="phone" required><br><br>

  <label>Address:</label><br>
  <textarea id="address" required></textarea><br><br>

  <button type="submit">Place Order</button>
</form>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBu2IUZ2RpB_pv0zA5nXqL7ur0uKZc8btE",
  authDomain: "indian-sellar-marketplac-d6395.firebaseapp.com",
  databaseURL: "https://indian-sellar-marketplac-d6395-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "indian-sellar-marketplac-d6395",
  storageBucket: "indian-sellar-marketplac-d6395.firebasestorage.app",
  messagingSenderId: "35436518492",
  appId: "1:35436518492:web:24c75eb5b85cd8f7d71a99"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

document.getElementById('checkoutForm').addEventListener("submit", (e) => {
  e.preventDefault();

  let order = {
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    address: document.getElementById("address").value,
    product: localStorage.getItem("selectedProduct") || "Unknown Product",
    date: new Date().toLocaleString()
  };

  const ordersRef = ref(db, "orders");
  const newOrderRef = push(ordersRef);

  set(newOrderRef, order)
    .then(() => {
      alert("Order Placed Successfully!");
      window.location.href = "orders.html";
    })
    .catch((err) => alert("Error: " + err));
});
</script>
